<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simple Wright-Fisher · EvoDynamics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">EvoDynamics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../model_description/">Model Parameters and Simulation Outline</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Simple Wright-Fisher</a></li><li><a class="tocitem" href="../example2/">Predator prey</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Simple Wright-Fisher</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simple Wright-Fisher</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kavir1698/EvoDynamics.jl/blob/master/examples/example1.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Simple-Wright-Fisher"><a class="docs-heading-anchor" href="#Simple-Wright-Fisher">Simple Wright-Fisher</a><a id="Simple-Wright-Fisher-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-Wright-Fisher" title="Permalink"></a></h1><p>In this example, we demonstrate how to create and run simple Wright-Fisher simulations using EvoDynamics.jl. The Wright-Fisher model is a classic population genetics model that describes the genetic drift in a population due to random sampling during reproduction. EvoDynamics.jl allows us to simulate the dynamics of a single haploid species in an unstructured space, with two genes affecting both biotic and abiotic traits.</p><p>To get started, we first import the EvoDynamics.jl package:</p><pre><code class="language-julia hljs">using EvoDynamics</code></pre><p>Next, we define the model parameters for our simple one-species Wright-Fisher simulation. The parameters are organized in a Julia (.jl) file as follows:</p><pre><code class="language-julia hljs">generations = 20
space = (1, 1)

## 1. Species parameters

species1 = Dict(
  :name =&gt; &quot;a&quot;,
  :number_of_genes =&gt; 2,
  :number_of_phenotypes =&gt; 2,
  :abiotic_phenotypes =&gt; [1],
  :biotic_phenotypes =&gt; [2],
  :migration_phenotype =&gt; 0,
  :migration_threshold =&gt; 3.5,
  :vision_radius =&gt; 0,
  :check_fraction =&gt; 0.0,
  :ploidy =&gt; 1,
  :epistasis_matrix =&gt; [1.0 0.0; 0.0 1.0],
  :pleiotropy_matrix =&gt; Bool[1 0; 0 1],
  :growth_rate =&gt; 1.0,
  :expression_array =&gt; [0.28, 0.46],
  :selection_coefficient =&gt; 0.1,
:phenotype_contribution_to_fitness =&gt; nothing,
  :mutation_probabilities =&gt; [0.9, 0.0, 0.0],
  :mutation_magnitudes =&gt; [0.05, 0.0, 0.0],
  :N =&gt; [100],
  :environmental_noise =&gt; 0.01,
  :optimal_phenotypes =&gt; [fill([1.5 for p in 1:1], space...) for t in 0:generations],
  :bottlenecks =&gt; [fill(0.0, space...) for t in 0:generations],
  :age =&gt; 2,
  :recombination =&gt; 0,
  :initial_energy =&gt; 0,
  :reproduction_start_age =&gt; 1,
  :reproduction_end_age =&gt; 2,
  :abiotic_variance =&gt; 1.0,
  :biotic_variance =&gt; 1.0,
  :mating_scheme =&gt; 1
)

## 2. Model parameters

#NB this dict should be called model_parameters
model_parameters = Dict(
  :species =&gt; [species1],
  :generations =&gt; generations,
  :space =&gt; space,
  :metric =&gt; &quot;chebyshev&quot;,
  :periodic =&gt; false,
  :resources =&gt; [fill(200, 1, 1) for i in 0:generations],
  :interactions =&gt; [-0.1],
  :food_sources =&gt; [1.0],
  :seed =&gt; nothing
)</code></pre><p>In this example, we set the number of generations to 20 and define an unstructured space with a single site (1, 1). The species parameters are specified for a single species named &quot;a&quot;, which has two genes influencing two phenotypes (one abiotic and one biotic). The model parameters include information about the species, generation count, space dimensions, metric type, periodic boundaries, resource availability, species interactions, and random seed.</p><p>To run the simulation, we use the runmodel function, passing the parameter file path as an argument:</p><pre><code class="language-julia hljs">param_file = &quot;../examples/paramfile1.jl&quot;

agentdata, modeldata = runmodel(param_file);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Loading the parameters...
[ Info: Running the model...</code></pre><p>By default, <code>runmodel</code> uses the following functions for data collection: <code>mean_fitness_per_species</code>, <code>species_N</code>. They collect the mean fitness and the population size of each species per time step. This is just a sample data. However, you can customize your own data collection function to gather specific information from the model (see <a href="../tutorial/#Collecting-data">Collecting data</a>).</p><p>Finally, we can examine the results of the simulation by inspecting the <code>modeldata</code>:</p><pre><code class="language-julia hljs">modeldata</code></pre><div><div style = "float: left;"><span>21×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">step</th><th style = "text-align: left;">mean_fitness_per_species</th><th style = "text-align: left;">species_N</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Vector{Float64}" style = "text-align: left;">Array…</th><th title = "Vector{Int64}" style = "text-align: left;">Array…</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: left;">[0.922243]</td><td style = "text-align: left;">[100]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: left;">[0.922453]</td><td style = "text-align: left;">[170]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">2</td><td style = "text-align: left;">[0.921963]</td><td style = "text-align: left;">[216]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">3</td><td style = "text-align: left;">[0.922348]</td><td style = "text-align: left;">[326]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">4</td><td style = "text-align: left;">[0.922177]</td><td style = "text-align: left;">[336]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">5</td><td style = "text-align: left;">[0.922162]</td><td style = "text-align: left;">[363]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">6</td><td style = "text-align: left;">[0.922065]</td><td style = "text-align: left;">[320]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">7</td><td style = "text-align: left;">[0.922055]</td><td style = "text-align: left;">[343]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">8</td><td style = "text-align: left;">[0.922248]</td><td style = "text-align: left;">[364]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">9</td><td style = "text-align: left;">[0.922063]</td><td style = "text-align: left;">[313]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">10</td><td style = "text-align: left;">[0.921939]</td><td style = "text-align: left;">[333]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: right;">11</td><td style = "text-align: left;">[0.922012]</td><td style = "text-align: left;">[336]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: right;">12</td><td style = "text-align: left;">[0.92203]</td><td style = "text-align: left;">[333]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: right;">13</td><td style = "text-align: left;">[0.921779]</td><td style = "text-align: left;">[316]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: right;">14</td><td style = "text-align: left;">[0.921369]</td><td style = "text-align: left;">[311]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: right;">15</td><td style = "text-align: left;">[0.921807]</td><td style = "text-align: left;">[322]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: right;">16</td><td style = "text-align: left;">[0.921588]</td><td style = "text-align: left;">[332]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: right;">17</td><td style = "text-align: left;">[0.92216]</td><td style = "text-align: left;">[318]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: right;">18</td><td style = "text-align: left;">[0.923702]</td><td style = "text-align: left;">[323]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: right;">19</td><td style = "text-align: left;">[0.924436]</td><td style = "text-align: left;">[337]</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: right;">20</td><td style = "text-align: left;">[0.925012]</td><td style = "text-align: left;">[324]</td></tr></tbody></table></div><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../example2/">Predator prey »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 22 May 2023 18:44">Monday 22 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

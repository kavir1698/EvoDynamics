<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Parameters and Simulation Outline · EvoDynamics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">EvoDynamics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Model Parameters and Simulation Outline</a><ul class="internal"><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Simulation-outline"><span>Simulation outline</span></a></li></ul></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../example1/">Simple Wright-Fisher</a></li><li><a class="tocitem" href="../example2/">Predator prey</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Model Parameters and Simulation Outline</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Parameters and Simulation Outline</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kavir1698/EvoDynamics.jl/blob/master/docs/src/model_description.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-Parameters-and-Simulation-Outline"><a class="docs-heading-anchor" href="#Model-Parameters-and-Simulation-Outline">Model Parameters and Simulation Outline</a><a id="Model-Parameters-and-Simulation-Outline-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Parameters-and-Simulation-Outline" title="Permalink"></a></h1><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><p>All model parameters are stored in a Julia (.jl) file and divided into two sections: species-specific parameters and model-specific parameters. Parameters for each species and the model are written in separate Dict objects, with keys represented as Symbols (using a colon : before the names).</p><p>To parameterize a model, you can copy an existing set of parameters from the Examples section and modify them accordingly.</p><h3 id=".-Species-specific-parameters"><a class="docs-heading-anchor" href="#.-Species-specific-parameters">1. Species specific parameters</a><a id=".-Species-specific-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#.-Species-specific-parameters" title="Permalink"></a></h3><p>Each species should have a dictionary object containing the following parameters. The order in which they are written does not matter.</p><ul><li><strong>name</strong>: A <code>String</code> representing the name of the species.</li><li><strong>number_of_genes</strong>: An <em>integer</em> indicating the number of genes that the species has.</li><li><strong>ploidy</strong>: Either 1 for haploid or 2 for diploid genomes. Diploids may undergo recombination.</li><li><strong>number_of_phenotypes</strong>: An <em>integer</em> indicating the number of phenotypes that the species has.</li><li><strong>abiotic_phenotypes</strong>: An <em>array of integers</em> specifying abiotic phenotypes among all phenotypes. Abiotic phenotypes determine how the species interacts with the environment.</li><li><strong>biotic_phenotypes</strong>: An <em>array of integers</em> specifying biotic phenotypes among all phenotypes. Biotic phenotypes determine how the species interacts with other individuals from the same or different species.</li><li><strong>migration_phenotype</strong>: An <em>integer</em> specifying the phenotype that corresponds to the migration trait. If the species does not migrate, put 0.</li><li><strong>migration_threshold</strong>: The phenotypic value of the migration phenotype after which an individual can migrate.</li><li><strong>vision_radius</strong>: A <em>number</em> determining the radius of neighboring sites that the agent can see before migration.</li><li><strong>check_fraction</strong>: A <em>floating-point number</em> between 0 and 1 representing the fraction of visible sites that the agent can check and decide whether to migrate to.</li><li><strong>epistasis_matrix</strong>: An epistasis matrix of size <code>l x l</code>, where <code>l</code> is the product of the number of genes and ploidy. The epistasis matrix specifies the direction (positive or negative) and size of the effect of one locus on other loci. For example, if at row 1 and column 2 is a value 0.2, it means that locus 1 affects locus 2 by increasing the effect of locus 2 (because its positive) with 20% of the effect of locus 1.</li><li><strong>pleiotropy_matrix</strong>: A <em>binary matrix</em> (0s and 1s) with size <em>number of phenotypes</em> x <em>l</em>. The pleiotropy matrix specifies the phenotypes that each locus affects.</li><li><strong>expression_array</strong>: A <em>vector</em> of size <em>l</em> representing the expression amount of each locus determining its effect size.</li><li><strong>growth_rate</strong>: The mean of a Poisson distribution for the number of offspring per reproduction. This number is fully realized when the fitness of a haploid individual is 1 or the distance between the biotic phenotypes of two diploid individuals is 0. Otherwise, the actual growth rate is a fraction of this value.</li><li><strong>selection_coefficient</strong>: A number between 0 and 1 that determines the importance of fitness. 0 represents a model without selection. To specify time-variable selection coefficient, provide a vector with a length equal to the number of generations plus 1 (to account for generation zero).</li><li><strong>phenotype_contribution_to_fitness</strong>: The relative contribution of each <strong>abiotic phenotype</strong> to fitness. This parameter can be <code>nothing</code> to denote equal contribution of all abiotic phenotypes, or it can be a vector of numbers with as many elements as there are abiotic phenotypes.</li><li><strong>mutation_probabilities</strong>: A <em>vector of three numbers</em> each of which specifies the probability for a different type of mutations: mutation probability of the <code>expression_array</code>, <code>pleiotropy_matrix</code>, and <code>epistasis_matrix</code>, respectively.</li><li><strong>mutation_magnitudes</strong>: A <em>vector of numbers</em> with the same size as <code>mutation_probabilities</code> that determines the magnitude of mutation for each of the three categories. Specifically, the numbers represent the variances of normal distributions with mean 0 for the expression array and epistasis matrices, and the probability of changing a 0 and 1 in the pleiotropy matrix. When mutating an offspring, it first checks whether there will be a mutation (<code>mutation_probabilities</code>), and if positive, a mutation with a magnitude determined by <em>mutation\</em>magnitudes_ occurs.</li><li><strong>N</strong>: A <em>vector of integers</em> representing the initial number of individuals at each site.</li><li><strong>environmental_noise</strong>: A number for the variance of a normal distribution with mean 0 that will be added to the phenotypes.</li><li><strong>optimal_phenotypes</strong>: A <em>vector of matrices</em> representing the optimal phenotypes at each time step. Each matrix represents the optimal phenotypes for each site in space. The optimal phenotype at each site is a vector as long as the <code>abiotic_phenotypes</code>. The vector is as long as the number of model steps (generations) plus 1 (for time zero).</li><li><strong>age</strong>: An <em>integer</em> for the maximum age of individuals of this species.</li><li><strong>reproduction_start_age</strong>: The age at which individuals can reproduce.</li><li><strong>reproduction_end_age</strong>: The age after which individuals cannot reproduce.</li><li><strong>recombination</strong>: The mean of a Poisson distribution for the number of crossing overs per sexual reproduction.</li><li><strong>initial_energy</strong>: A parameter for parental care of infants. Values greater than 0 indicate that newly born individuals can survive for a certain number of time steps without requiring food from the environment or other species. The consumption rate is always constant for all species at one unit per time step. Use with caution as having an initial energy larger than zero can lead to infinite population growth when individuals without food reproduce and their offspring also reproduce without food. For example, this happens when start age of reproduction is 1 and initial energy is larger than 0.</li><li><strong>bottlenecks</strong>: A vector of matrices, each of which has the same size as the space and contains the probability of death at each site. The vector is as long as the number of model steps (generations) plus 1 (for time zero). Use this if you want to impose a killing event in the model at specific times and places. Otherwise, use 0.0 for all the values in the matrices.</li><li><strong>mating_scheme</strong>: One of the following: -1, 0, 1. Only used in sexual reproduction. Zero means randomly paired couples are likely to have as many offspring as any other pair. Their phenotypes do not affect their reproductive success. -1 represents disassortative mating, where the more different the phenotypes of the pair, the more children they have. 1 represents assortative mating, where individuals with similar phenotypes are more likely to reproduce.</li><li><strong>abiotic_variance</strong>: The variance of a normal distribution used in determining the phenotypic distance of agents to the optimal environmental phenotypes. The larger the variance, the less important is the distance.</li><li><strong>biotic_variance</strong>: The variance of a normal distribution used in determining the biotic phenotypic distance between two individuals (used in any kind of interaction). Larger values mean that all pairs are equally likely to interact, regardless of their phenotype difference.</li></ul><h3 id=".-Model-parameters"><a class="docs-heading-anchor" href="#.-Model-parameters">2. Model parameters</a><a id=".-Model-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#.-Model-parameters" title="Permalink"></a></h3><p>This dictionary should be named &quot;model_parameters&quot;.</p><ul><li><strong>species</strong>: A vector containing the dictionaries of the species.</li><li><strong>generations</strong>: An integer indicating the number of steps the model will run.</li><li><strong>space</strong>:A tuple of two integers (e.g., <code>(3,2)</code>) determining the size of space. If you do not want any spatial structure, use <code>(1,1)</code>.</li><li><strong>metric</strong>: Either &quot;chebyshev&quot; or &quot;euclidean&quot;. Determines how many neighbors a space site has. &quot;chebyshev&quot; metric means that the r-neighborhood of a position includes all positions within the hypercube with a side length of 2 * floor(r) and centered at the origin position. &quot;euclidean&quot; metric means that the r-neighborhood of a position includes all positions whose Cartesian indices have Euclidean distance ≤ r from the Cartesian index of the given position.</li><li><strong>periodic</strong>: A Boolean value (true or false) determining whether the boundaries of the space are connected or not.</li><li><strong>resources</strong>: A vector of matrices where each matrix has the size of the space and determines the amount of resources per site. The vector is as long as the number of model steps (generations) plus 1 (for time zero).</li><li><strong>interactions</strong>: A species-species interaction matrix of floating-point numbers determining how individuals from different species interact. Each value represents the strength of interaction (between 0 and 1). The sign (+/-) indicates the direction of interaction, where a positive value means similar individuals interact more strongly, and a negative value means dissimilar individuals tend to interact more.</li><li><strong>food_sources</strong>: A species-species food matrix of floating-point numbers determining what each species feeds on (consumption rate). Non-zero values on the diagonal indicate that the food resource is from the environment. Off-diagonal values indicate that a species (in the rows) feeds on another species (in the columns). Numbers can be zero or any positive number. The magnitude of the number determines how much energy the predator gains by eating the prey. All species use 1 unit of energy per time step.</li><li><strong>seed</strong>: Either an integer or <code>nothing</code> for a random number.</li></ul><h2 id="Simulation-outline"><a class="docs-heading-anchor" href="#Simulation-outline">Simulation outline</a><a id="Simulation-outline-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-outline" title="Permalink"></a></h2><p>The simulations are fully agent-based, meaning that agents do not receive any model-level knowledge about what happens to them. The following steps occur in order for agents that are activated in a random order:</p><ol><li>Grow one step older.</li><li>Migrate.</li><li>Burn energy.</li><li>Eat from the environment if the species can.</li><li>Interact with other individuals.</li><li>Reproduce.</li><li>Survive. Agents die if they are too old, or do not have enough energy, or by chance given its fitness.</li><li>Kill agents with a probability given in <code>bottlenecks</code>.</li></ol><h3 id="Migration"><a class="docs-heading-anchor" href="#Migration">Migration</a><a id="Migration-1"></a><a class="docs-heading-anchor-permalink" href="#Migration" title="Permalink"></a></h3><p>If a species has the capability to migrate (i.e., <code>migration_phenotype</code> is not 0), then at each time step, it is checked whether the phenotypic value of the migration phenotype is above the <code>migration_threshold</code>. If it is, then the agent checks a random <code>check_fraction</code> of the neighboring sites and moves to the most suitable site. Suitability is calculated by comparing the agent&#39;s abiotic phenotype and the optimal abiotic phenotypic value for each site. If the checked neighbors have worse conditions than the current site, the agent does not move.</p><h3 id="Burn-energy"><a class="docs-heading-anchor" href="#Burn-energy">Burn energy</a><a id="Burn-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Burn-energy" title="Permalink"></a></h3><p>Agent&#39;s energy is reduced by one unit.</p><h3 id="Eat"><a class="docs-heading-anchor" href="#Eat">Eat</a><a id="Eat-1"></a><a class="docs-heading-anchor-permalink" href="#Eat" title="Permalink"></a></h3><p>If the agent is able to eat from the environment (the diagonal of <code>food_sources</code> at the corresponding row and column is non-zero) and there are any environmental resources left at the agent&#39;s site, its energy level is boosted by the value in the corresponding element at <code>food_sources</code>.</p><h3 id="Interacting-with-other-individuals"><a class="docs-heading-anchor" href="#Interacting-with-other-individuals">Interacting with other individuals</a><a id="Interacting-with-other-individuals-1"></a><a class="docs-heading-anchor-permalink" href="#Interacting-with-other-individuals" title="Permalink"></a></h3><p>At each time step, the agent interacts with individuals from each species in the model. If there are fewer agents at the site than the number of species, the agent interacts with all of them. Otherwise, it interacts with at most one randomly chosen individual from each species. If most of the individuals at the site are from the first species, then the agent is more likely to interact with an individual from the first species and with no individual from the second species. This setup allows interactions between species to depend on the population size of the species at each site.</p><p>For each pair of interacting individuals, it is first checked whether one individual feeds on the other. If so, the hunt is successful with a probability proportional to the average phenotypic distance between the biotic phenotypes of the two individuals.</p><p>The phenotypic distance between two species depends on the sign of the corresponding element in the <code>interactions</code> matrix. If it is negative, the hunt is more successful when the average phenotype of the two individuals is more different.</p><p>The phenotypic distance between two individuals is calculated as the average distance between all pairs of biotic phenotypes between the two individuals. The distance between two phenotypic values is determined using the formula:</p><p>$ | 0.5 - \text{cdf}(\text{Normal}(\text{ph1},  1), \text{ph2})| $</p><p>where <code>cdf</code> is the cumulative density function, <code>Normal</code> is a normal distribution with mean <code>ph1</code> (phenotypic value 1) and variance 1, and <code>ph2</code> is phenotypic value 2.</p><p>If the two individuals are not predator-prey and they are from the same species but different sexes, and both are in reproductive age, they are marked to reproduce in the next stage. Otherwise, if they are from different species and the two species interact with each other (the corresponding values in the <code>interactions</code> matrix are non-zero), they interact with each other. If the individual from species 1 to species 2 has a positive value in the <code>interactions</code> matrix, it increases the fitness of the individual from species 2. If the element is zero, it does not affect the fitness of the individual from species 2. And if the element is negative, it decreases the fitness of the individual from species 2. Similarly, the individual from species 2 can affect the fitness of the individual from species 1. The two interactions do not need to be symmetric. The magnitude of change in fitness due to interaction is determined by the phenotypic distance between the two individuals and the interaction value in the <code>interactions</code> matrix.</p><h3 id="Reproduction"><a class="docs-heading-anchor" href="#Reproduction">Reproduction</a><a id="Reproduction-1"></a><a class="docs-heading-anchor-permalink" href="#Reproduction" title="Permalink"></a></h3><p>If an individual is haploid and in reproductive age, it reproduces an identical offspring to itself, except that the expression array, pleiotropy matrix, and the epistasis matrix of the offspring will mutate based on the probabilities and magnitudes in the <code>mutation_probabilities</code> and <code>mutation_magnitudes</code> matrices. The number of offspring is a random number from a Poisson distribution with a mean equal to the species&#39; growth rate times the fitness of the individual.</p><p>If two diploid individuals mate to reproduce, their reproductive success is proportional to their phenotypic distance (depending on <code>mating_scheme</code>). The number of offspring is a random number from a Poisson distribution with a mean equal to the reproductive success of the two individuals times the growth rate of the species.</p><p>Each offspring of diploid individuals inherits a gamete from each parent. A gamete is half of the expression array, pleiotropy matrix, and epistasis matrix. If recombination is allowed (value &gt; 0), then the gametes undergo crossing over. The number of crossing overs is a random number from a Poisson distribution with a mean equal to the <code>recombination</code> parameter.</p><h4 id="Survival"><a class="docs-heading-anchor" href="#Survival">Survival</a><a id="Survival-1"></a><a class="docs-heading-anchor-permalink" href="#Survival" title="Permalink"></a></h4><p>At each step, the agent may die due to several factors. First, it dies if it has negative energy (has not been able to eat enough). Second, it dies if it is too old (greater than the maximum age). Third, it dies with a probability negatively correlated to its fitness. This probability is adjusted by the <code>selection_coefficient</code>. If the selection coefficient is zero, then the individual does not die. If it is one, the fitness determines a 100% survival rate.</p><h4 id="Fitness"><a class="docs-heading-anchor" href="#Fitness">Fitness</a><a id="Fitness-1"></a><a class="docs-heading-anchor-permalink" href="#Fitness" title="Permalink"></a></h4><p>The fitness of individuals is determined by their abiotic fitness, i.e., their abiotic phenotypic distance to the optimal phenotypes in the environment. Thus, their fitness can vary at different sites.</p><h4 id="Mutation"><a class="docs-heading-anchor" href="#Mutation">Mutation</a><a id="Mutation-1"></a><a class="docs-heading-anchor-permalink" href="#Mutation" title="Permalink"></a></h4><p>Mutation can occur at three levels: changing the expression of each gene, changing the pleiotropy matrix, and changing the epistasis interactions between genes. The probability that a mutation occurs at each of these levels is controlled by the <code>mutation_probabilities</code> parameter. The size of mutations, when they occur, is controlled by the <code>mutation_magnitudes</code> parameter, which represents the variances of normal distributions. A mutation in the gene expression and epistasis matrix is carried out by adding a random number from a normal distribution to the existing values. The pleiotropy matrix is mutated by switching 0s and 1s with the probability given in the third element of <code>mutation_magnitudes</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../tutorial/">Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 16 October 2023 10:06">Monday 16 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
